box: wercker/golang@1.1.2

steps:
    - wercker/email-notify@1.0.0

build:
    steps:
        - setup-go-workspace

        # Gets the dependencies
        - script:
            name: go get
            code: |
                cd $WERCKER_SOURCE_DIR
                go version
                go get -t

        # Build the project
        - script:
            name: go build
            code: |
                go build

        # Test the project
        - script:
            name: go test
            code: |
                go test

    after-steps:
        - email-notify:
            from: alerts@wercker.com
            to: johan.samyn@gmail.com
            username: johan.samyn@gmail.com
            password: $EMAIL_PASSWORD
            host: smtp.gmail.com:587
            # passed-subject: "wercker [PASS]: JohanSamyn/gohg: build of master by Johan Samyn passed."
            failed-subject: "wercker [FAIL]: JohanSamyn/gohg: build of master by Johan Samyn failed."
